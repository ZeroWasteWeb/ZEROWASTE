<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zero Waste, Zero Hunger</title>
<link rel="stylesheet" href="style.css"> 
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
 integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
 integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
<style>
    #map { height: 400px; margin-bottom: 20px; }
    .popup-image { max-width: 200px; height: auto; }
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    header { padding: 10px 20px; background: #4CAF50; color: white; display: flex; justify-content: space-between; align-items: center; }
    .nav-links a { color: white; margin-left: 15px; text-decoration: none; }
    .hero { padding: 20px; background: #f4f4f4; }
    .form-container { display: flex; flex-direction: column; padding: 20px; }
    .form-group { margin-bottom: 15px; }
    label { display: block; margin-bottom: 5px; font-weight: bold; }
    input, textarea, button { width: 100%; padding: 8px; box-sizing: border-box; }
    button { background: #4CAF50; color: white; border: none; cursor: pointer; }
    button:hover { background: #45a049; }
</style>
</head>
<body>

<h1>Map</h1>
<div id="map"></div>

<header class="header">
    <div class="logo">Zero Waste, Zero Hunger</div>
    <nav class="nav-links">
        <a href="mission.html">Our Mission</a>
    </nav>
</header>

<section class="hero">
    <h1>Stop hunger and make sure everyone has enough food.</h1>
    <p>Connecting all the extra food to the people and communities that need it.</p>
</section>

<div class="form-header">RescueFeeds: Food Donation Form</div>

<section class="rescue-feeds">
    <div class="form-container">
        <div class="form-section">
            <p>Tell us about your extra food, We will quickly connect it to local groups and helpers. Every gift of food makes a difference!</p>
            <form id="donationForm">
                <div class="form-group">
                    <label for="orgName">Your Name (or Business)</label>
                    <input type="text" id="orgName" name="orgName">
                </div>
                <div class="form-group">
                    <label for="foodDescription">What Food Are You Giving?</label>
                    <textarea id="foodDescription" name="foodDescription"></textarea>
                </div>
                <div class="form-group">
                    <label for="donationAmountKg">Donation Amount (kg)</label>
                    <input type="number" id="donationAmountKg" name="donationAmountKg" min="1" value="0">
                </div>
                <div class="form-group">
                    <label for="pickupTime">Ready for Pickup By</label>
                    <input type="datetime-local" id="pickupTime" name="pickupTime">
                </div>
                <div class="form-group">
                    <label for="pickupAddress">Full Pickup Address</label>
                    <input type="text" id="pickupAddress" name="pickupAddress">
                </div>
                <button type="submit" class="submit-btn">Submit Donation</button>
            </form>
        </div>
    </div>
</section>

<script>
function initMap(mapDataUrl){

    const map = L.map('map').setView([8.4210, 124.8885], 16);

    const openStreetMap = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png',{
        maxZoom: 19,
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    const satellite = L.tileLayer(
        'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
        { attribution: 'Tiles (c) Esri - Source: Esri, Maxar, Earthstar Geographics, GIS User Community' }
    );

    const mainPin = L.marker([8.4210, 124.8885]).addTo(map);
    mainPin.bindPopup(`
        <img src="https://i.imgur.com/U5ZlqvC.png" style="width:180px; border-radius:8px;">
        <br><b>Food Donation Drop-off Point</b><br>Zero Hunger Initiative
    `).openPopup();

    const markerGroups = {};

    fetch(mapDataUrl)
        .then(response => response.json())
        .then(data => {
            data.forEach(pin => {
                const type = pin.locationType || "Other";
                const marker = L.marker([pin.lat, pin.lng])
                    .bindPopup(`<b>${pin.name}</b><br>${pin.description || ""}`);
                
                if(!markerGroups[type]) markerGroups[type] = L.layerGroup();
                markerGroups[type].addLayer(marker);
            });

            const overlayMaps = {};
            Object.keys(markerGroups).forEach(type => overlayMaps[type] = markerGroups[type]);

            L.control.layers({ "OpenStreetMap": openStreetMap, "Satellite": satellite }, overlayMaps, { collapsed:false }).addTo(map);
        })
        .catch(err => console.error('Error loading JSON', err));
}

document.addEventListener("DOMContentLoaded", () => {
    initMap('campus-map.json');
});
</script>

</body>
</html>